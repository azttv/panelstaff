<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>True Vanilla - Admin Panel</title>
        <link rel="icon" type="image/png" href="icons/favicon.png" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        />
        <style>
            /* ═══════════════════════════════════════════════════════
           ROOT VARIABLES & RESET
           ═══════════════════════════════════════════════════════ */
            :root {
                --bg-dark: #0a0d12;
                --bg-darker: #060810;
                --bg-card: #111827;
                --bg-card-hover: #1a2332;
                --bg-input: rgba(0, 0, 0, 0.35);
                --accent-aqua: #06b6d4;
                --accent-aqua-light: #22d3ee;
                --accent-aqua-glow: rgba(6, 182, 212, 0.3);
                --accent-aqua-subtle: rgba(6, 182, 212, 0.1);
                --accent-blue: #3b82f6;
                --accent-purple: #8b5cf6;
                --accent-green: #10b981;
                --accent-red: #ef4444;
                --accent-yellow: #f59e0b;
                --accent-orange: #f97316;
                --text-primary: #f1f5f9;
                --text-secondary: #94a3b8;
                --text-muted: #64748b;
                --border-subtle: rgba(255, 255, 255, 0.08);
                --border-aqua: rgba(6, 182, 212, 0.3);
                --glass-bg: rgba(17, 24, 39, 0.92);
                --sidebar-width: 260px;
                --discord-bg: #36393f;
                --discord-embed: #2f3136;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            html {
                scroll-behavior: smooth;
            }

            body {
                font-family: "Outfit", sans-serif;
                background: var(--bg-dark);
                color: var(--text-primary);
                min-height: 100vh;
                overflow: hidden;
            }

            ::-webkit-scrollbar {
                width: 6px;
            }
            ::-webkit-scrollbar-track {
                background: transparent;
            }
            ::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 3px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 255, 255, 0.2);
            }

            /* ═══════════════════════════════════════════════════════
           ANIMATED BACKGROUND
           ═══════════════════════════════════════════════════════ */
            .bg-pattern {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 0;
                pointer-events: none;
                background:
                    radial-gradient(
                        ellipse at 15% 30%,
                        rgba(6, 182, 212, 0.1) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        ellipse at 85% 70%,
                        rgba(59, 130, 246, 0.06) 0%,
                        transparent 50%
                    ),
                    radial-gradient(
                        ellipse at 50% 100%,
                        rgba(6, 182, 212, 0.04) 0%,
                        transparent 60%
                    );
            }

            .particles {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 0;
                pointer-events: none;
                overflow: hidden;
            }
            .particle {
                position: absolute;
                width: 3px;
                height: 3px;
                background: var(--accent-aqua);
                border-radius: 50%;
                opacity: 0;
                animation: float-particle 12s infinite ease-in-out;
            }
            @keyframes float-particle {
                0%,
                100% {
                    transform: translateY(100vh) scale(0);
                    opacity: 0;
                }
                10% {
                    opacity: 0.4;
                }
                90% {
                    opacity: 0.4;
                }
                100% {
                    transform: translateY(-10vh) scale(1);
                    opacity: 0;
                }
            }

            /* ═══════════════════════════════════════════════════════
           LOGIN SCREEN
           ═══════════════════════════════════════════════════════ */
            .login-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.95);
                backdrop-filter: blur(20px);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-direction: column;
                gap: 2rem;
                transition:
                    opacity 0.5s ease,
                    visibility 0.5s ease;
            }
            .login-overlay.hidden {
                opacity: 0;
                visibility: hidden;
                pointer-events: none;
            }

            .login-card {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 20px;
                padding: 3rem;
                width: 100%;
                max-width: 420px;
                text-align: center;
                position: relative;
                overflow: hidden;
            }
            .login-card::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background: linear-gradient(
                    90deg,
                    var(--accent-aqua),
                    var(--accent-blue),
                    var(--accent-aqua)
                );
                background-size: 200% 100%;
                animation: gradient-slide 3s linear infinite;
            }
            @keyframes gradient-slide {
                0% {
                    background-position: 0% 0;
                }
                100% {
                    background-position: 200% 0;
                }
            }

            .login-logo {
                margin-bottom: 1.5rem;
            }
            .login-logo img {
                width: 90px;
                height: 90px;
                filter: drop-shadow(0 0 20px var(--accent-aqua-glow));
            }
            .login-logo-text {
                font-family: "Cinzel", serif;
                font-size: 1.8rem;
                font-weight: 700;
                background: linear-gradient(
                    135deg,
                    var(--text-primary),
                    var(--accent-aqua)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                margin-top: 0.75rem;
            }
            .login-subtitle {
                color: var(--text-muted);
                font-size: 0.95rem;
                margin-bottom: 2rem;
            }

            .discord-login-btn {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.75rem;
                width: 100%;
                padding: 1rem 1.5rem;
                background: #5865f2;
                border: none;
                border-radius: 12px;
                color: white;
                font-family: "Outfit", sans-serif;
                font-size: 1.05rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                text-decoration: none;
            }
            .discord-login-btn:hover {
                background: #4752c4;
                transform: translateY(-2px);
                box-shadow: 0 8px 30px rgba(88, 101, 242, 0.4);
            }
            .discord-login-btn i {
                font-size: 1.3rem;
            }

            .login-error {
                background: rgba(239, 68, 68, 0.1);
                border: 1px solid rgba(239, 68, 68, 0.3);
                color: #fca5a5;
                padding: 0.75rem 1rem;
                border-radius: 10px;
                font-size: 0.9rem;
                margin-top: 1.5rem;
                display: none;
            }
            .login-error.show {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .login-badge {
                display: inline-flex;
                align-items: center;
                gap: 0.4rem;
                font-size: 0.8rem;
                color: var(--text-muted);
                margin-top: 1.5rem;
                padding: 0.4rem 0.8rem;
                background: rgba(255, 255, 255, 0.03);
                border-radius: 20px;
            }
            .login-badge i {
                color: var(--accent-aqua);
                font-size: 0.7rem;
            }

            /* ═══════════════════════════════════════════════════════
           APP LAYOUT
           ═══════════════════════════════════════════════════════ */
            .app-container {
                display: none;
                position: relative;
                z-index: 1;
                height: 100vh;
                width: 100%;
            }
            .app-container.visible {
                display: flex;
            }

            /* ═══════════════════════════════════════════════════════
           SIDEBAR
           ═══════════════════════════════════════════════════════ */
            .sidebar {
                width: var(--sidebar-width);
                height: 100vh;
                background: var(--glass-bg);
                backdrop-filter: blur(20px);
                border-right: 1px solid var(--border-subtle);
                display: flex;
                flex-direction: column;
                flex-shrink: 0;
                position: relative;
                z-index: 10;
            }

            .sidebar-header {
                padding: 1.25rem 1.5rem;
                display: flex;
                align-items: center;
                gap: 0.75rem;
                border-bottom: 1px solid var(--border-subtle);
            }
            .sidebar-logo {
                width: 40px;
                height: 40px;
                filter: drop-shadow(0 0 8px var(--accent-aqua-glow));
                border-radius: 10px;
            }
            .sidebar-brand {
                font-family: "Cinzel", serif;
                font-size: 1rem;
                font-weight: 700;
                color: var(--text-primary);
            }
            .sidebar-brand small {
                display: block;
                font-family: "Outfit", sans-serif;
                font-size: 0.7rem;
                font-weight: 400;
                color: var(--accent-aqua);
                letter-spacing: 0.1em;
                text-transform: uppercase;
            }

            .sidebar-nav {
                flex: 1;
                padding: 1rem 0.75rem;
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
            }

            .sidebar-item {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.8rem 1rem;
                border-radius: 10px;
                color: var(--text-secondary);
                font-size: 0.9rem;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.25s ease;
                position: relative;
                border: 1px solid transparent;
            }
            .sidebar-item:hover {
                background: rgba(6, 182, 212, 0.06);
                color: var(--text-primary);
            }
            .sidebar-item.active {
                background: rgba(6, 182, 212, 0.1);
                color: var(--accent-aqua);
                border-color: var(--border-aqua);
            }
            .sidebar-item.active::before {
                content: "";
                position: absolute;
                left: -0.75rem;
                top: 50%;
                transform: translateY(-50%);
                width: 3px;
                height: 60%;
                background: var(--accent-aqua);
                border-radius: 0 3px 3px 0;
            }
            .sidebar-item i {
                width: 20px;
                text-align: center;
                font-size: 1rem;
            }

            .sidebar-separator {
                height: 1px;
                background: var(--border-subtle);
                margin: 0.75rem 1rem;
            }
            .sidebar-label {
                font-size: 0.7rem;
                text-transform: uppercase;
                letter-spacing: 0.15em;
                color: var(--text-muted);
                padding: 0.5rem 1rem;
                font-weight: 600;
            }

            .sidebar-user {
                padding: 1rem 1.25rem;
                border-top: 1px solid var(--border-subtle);
                display: flex;
                align-items: center;
                gap: 0.75rem;
            }
            .sidebar-avatar {
                width: 36px;
                height: 36px;
                border-radius: 50%;
                border: 2px solid var(--accent-aqua);
            }
            .sidebar-username {
                font-size: 0.85rem;
                font-weight: 600;
                color: var(--text-primary);
            }
            .sidebar-userrole {
                font-size: 0.7rem;
                color: var(--accent-aqua);
            }
            .sidebar-logout {
                margin-left: auto;
                background: none;
                border: none;
                color: var(--text-muted);
                cursor: pointer;
                font-size: 1rem;
                transition: color 0.2s ease;
                padding: 0.4rem;
            }
            .sidebar-logout:hover {
                color: var(--accent-red);
            }

            /* ═══════════════════════════════════════════════════════
           MAIN CONTENT AREA
           ═══════════════════════════════════════════════════════ */
            .main-area {
                flex: 1;
                display: flex;
                flex-direction: column;
                height: 100vh;
                overflow: hidden;
                position: relative;
            }

            .content-scroll {
                flex: 1;
                overflow-y: auto;
                padding: 2rem;
                padding-bottom: 100px;
            }

            .tab-panel {
                display: none;
            }
            .tab-panel.active {
                display: block;
                animation: fadeIn 0.3s ease;
            }
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(8px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* ═══════════════════════════════════════════════════════
           SERVER SELECTOR BAR (top)
           ═══════════════════════════════════════════════════════ */
            .server-bar {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 0.75rem 2rem;
                background: var(--glass-bg);
                backdrop-filter: blur(12px);
                border-bottom: 1px solid var(--border-subtle);
            }
            .server-bar-left {
                display: flex;
                align-items: center;
                gap: 1rem;
            }
            .server-indicator {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-size: 0.85rem;
                color: var(--text-secondary);
            }
            .server-dot {
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: var(--accent-green);
                box-shadow: 0 0 8px rgba(16, 185, 129, 0.5);
            }
            .server-dot.offline {
                background: var(--accent-red);
                box-shadow: 0 0 8px rgba(239, 68, 68, 0.5);
            }
            .server-name-label {
                font-weight: 600;
                color: var(--text-primary);
            }

            .server-bar-right {
                display: flex;
                align-items: center;
                gap: 1.5rem;
            }
            .stat-chip {
                display: flex;
                align-items: center;
                gap: 0.4rem;
                font-size: 0.8rem;
                color: var(--text-secondary);
                padding: 0.3rem 0.7rem;
                background: rgba(255, 255, 255, 0.04);
                border-radius: 6px;
            }
            .stat-chip i {
                color: var(--accent-aqua);
                font-size: 0.75rem;
            }
            .stat-chip .val {
                color: var(--text-primary);
                font-weight: 600;
            }

            /* ═══════════════════════════════════════════════════════
           DASHBOARD TAB
           ═══════════════════════════════════════════════════════ */
            .dashboard-grid {
                display: grid;
                grid-template-columns: 1fr 320px;
                gap: 1.5rem;
                height: calc(100vh - 200px);
                min-height: 500px;
            }

            .panel {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 14px;
                overflow: hidden;
                display: flex;
                flex-direction: column;
            }
            .panel-header {
                padding: 0.9rem 1.25rem;
                display: flex;
                align-items: center;
                justify-content: space-between;
                border-bottom: 1px solid var(--border-subtle);
                flex-shrink: 0;
            }
            .panel-title {
                font-size: 0.9rem;
                font-weight: 600;
                color: var(--text-primary);
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .panel-title i {
                color: var(--accent-aqua);
            }

            /* Console */
            .console-ip {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-family: "JetBrains Mono", monospace;
                font-size: 0.8rem;
                color: var(--accent-aqua);
                padding: 0.3rem 0.75rem;
                background: rgba(6, 182, 212, 0.1);
                border-radius: 6px;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .console-ip:hover {
                background: rgba(6, 182, 212, 0.2);
            }

            .console-body {
                flex: 1;
                overflow-y: auto;
                padding: 0.75rem 1rem;
                font-family: "JetBrains Mono", monospace;
                font-size: 0.78rem;
                line-height: 1.7;
                background: var(--bg-darker);
                color: var(--text-secondary);
            }
            .console-line {
                padding: 1px 0;
            }
            .console-line .time {
                color: var(--text-muted);
            }
            .console-line .info {
                color: var(--accent-aqua);
            }
            .console-line .warn {
                color: var(--accent-yellow);
            }
            .console-line .error {
                color: var(--accent-red);
            }
            .console-line .player {
                color: var(--accent-green);
            }

            .console-input-bar {
                display: flex;
                padding: 0.5rem;
                gap: 0.5rem;
                border-top: 1px solid var(--border-subtle);
                background: var(--bg-card);
            }
            .console-input {
                flex: 1;
                padding: 0.6rem 0.9rem;
                background: var(--bg-input);
                border: 1px solid var(--border-subtle);
                border-radius: 8px;
                color: var(--text-primary);
                font-family: "JetBrains Mono", monospace;
                font-size: 0.82rem;
                outline: none;
                transition: border-color 0.2s ease;
            }
            .console-input:focus {
                border-color: var(--accent-aqua);
            }
            .console-input::placeholder {
                color: var(--text-muted);
            }

            .console-send {
                padding: 0.6rem 1rem;
                background: var(--accent-aqua);
                border: none;
                border-radius: 8px;
                color: var(--bg-dark);
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s ease;
                font-family: "Outfit", sans-serif;
                font-size: 0.8rem;
            }
            .console-send:hover {
                background: var(--accent-aqua-light);
            }

            /* Stats sidebar */
            .stats-column {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }

            .stat-card {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 14px;
                padding: 1.25rem;
            }
            .stat-card-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 1rem;
            }
            .stat-card-label {
                font-size: 0.8rem;
                color: var(--text-muted);
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }
            .stat-card-icon {
                width: 34px;
                height: 34px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.9rem;
            }
            .stat-card-icon.cpu {
                background: rgba(139, 92, 246, 0.15);
                color: var(--accent-purple);
            }
            .stat-card-icon.ram {
                background: rgba(59, 130, 246, 0.15);
                color: var(--accent-blue);
            }
            .stat-card-icon.players {
                background: rgba(16, 185, 129, 0.15);
                color: var(--accent-green);
            }

            .stat-card-value {
                font-size: 2rem;
                font-weight: 700;
                color: var(--text-primary);
                line-height: 1;
            }
            .stat-card-value small {
                font-size: 0.9rem;
                font-weight: 400;
                color: var(--text-muted);
            }

            .stat-bar-track {
                width: 100%;
                height: 6px;
                background: rgba(255, 255, 255, 0.06);
                border-radius: 3px;
                margin-top: 0.75rem;
                overflow: hidden;
            }
            .stat-bar-fill {
                height: 100%;
                border-radius: 3px;
                transition: width 1s ease;
            }
            .stat-bar-fill.cpu-fill {
                background: linear-gradient(
                    90deg,
                    var(--accent-purple),
                    #a78bfa
                );
            }
            .stat-bar-fill.ram-fill {
                background: linear-gradient(90deg, var(--accent-blue), #60a5fa);
            }

            .players-stat-card {
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .players-stat-card:hover {
                border-color: var(--accent-green);
                background: var(--bg-card-hover);
            }

            .player-count-list {
                margin-top: 0.75rem;
                display: flex;
                flex-direction: column;
                gap: 0.4rem;
            }
            .player-count-item {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-size: 0.82rem;
                color: var(--text-secondary);
            }
            .player-mini-head {
                width: 20px;
                height: 20px;
                border-radius: 4px;
                image-rendering: pixelated;
            }

            /* ═══════════════════════════════════════════════════════
           JOUEURS TAB
           ═══════════════════════════════════════════════════════ */
            .joueurs-layout {
                display: grid;
                grid-template-columns: 1fr 400px;
                gap: 1.5rem;
                height: calc(100vh - 200px);
            }
            .joueurs-layout.no-selection {
                grid-template-columns: 1fr;
            }

            .player-list-panel {
                display: flex;
                flex-direction: column;
            }
            .player-search-bar {
                display: flex;
                gap: 0.75rem;
                margin-bottom: 1rem;
            }
            .player-search {
                flex: 1;
                padding: 0.7rem 1rem 0.7rem 2.5rem;
                background: var(--bg-input);
                border: 1px solid var(--border-subtle);
                border-radius: 10px;
                color: var(--text-primary);
                font-family: "Outfit", sans-serif;
                font-size: 0.9rem;
                outline: none;
                transition: border-color 0.2s ease;
            }
            .player-search:focus {
                border-color: var(--accent-aqua);
            }
            .player-search-wrap {
                position: relative;
                flex: 1;
            }
            .player-search-wrap i {
                position: absolute;
                left: 0.9rem;
                top: 50%;
                transform: translateY(-50%);
                color: var(--text-muted);
                font-size: 0.85rem;
            }

            .player-grid {
                display: flex;
                flex-direction: column;
                gap: 0.4rem;
                overflow-y: auto;
                flex: 1;
            }

            .player-row {
                display: grid;
                grid-template-columns: 36px 1fr 80px 90px 60px 100px;
                align-items: center;
                gap: 0.75rem;
                padding: 0.65rem 1rem;
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .player-row:hover {
                border-color: var(--border-aqua);
                background: var(--bg-card-hover);
            }
            .player-row.selected {
                border-color: var(--accent-aqua);
                background: rgba(6, 182, 212, 0.08);
            }

            .player-head {
                width: 36px;
                height: 36px;
                border-radius: 6px;
                image-rendering: pixelated;
            }
            .player-name-cell {
                font-weight: 600;
                font-size: 0.9rem;
            }
            .player-world-cell {
                font-size: 0.78rem;
                color: var(--text-muted);
                display: flex;
                align-items: center;
                gap: 0.3rem;
            }
            .player-world-cell i {
                font-size: 0.7rem;
            }
            .world-overworld i {
                color: var(--accent-green);
            }
            .world-nether i {
                color: var(--accent-red);
            }
            .world-end i {
                color: var(--accent-purple);
            }

            .player-health-cell {
                display: flex;
                align-items: center;
                gap: 0.3rem;
                font-size: 0.8rem;
            }
            .health-bar-mini {
                width: 50px;
                height: 5px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 3px;
                overflow: hidden;
            }
            .health-bar-fill {
                height: 100%;
                background: var(--accent-red);
                border-radius: 3px;
                transition: width 0.5s ease;
            }

            .player-ping-cell {
                font-size: 0.78rem;
            }
            .ping-good {
                color: var(--accent-green);
            }
            .ping-medium {
                color: var(--accent-yellow);
            }
            .ping-bad {
                color: var(--accent-red);
            }

            .player-rank-cell {
                font-size: 0.72rem;
                font-weight: 600;
                padding: 0.2rem 0.6rem;
                border-radius: 20px;
                text-align: center;
                white-space: nowrap;
            }
            .rank-default {
                background: rgba(148, 163, 184, 0.15);
                color: var(--text-secondary);
            }
            .rank-vip {
                background: rgba(251, 191, 36, 0.15);
                color: #fbbf24;
            }
            .rank-staff {
                background: rgba(239, 68, 68, 0.15);
                color: #fca5a5;
            }
            .rank-admin {
                background: rgba(6, 182, 212, 0.15);
                color: var(--accent-aqua);
            }

            /* Player Detail Card */
            .player-detail {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 14px;
                overflow-y: auto;
                display: flex;
                flex-direction: column;
            }
            .player-detail-header {
                padding: 1.5rem;
                text-align: center;
                background: linear-gradient(
                    180deg,
                    rgba(6, 182, 212, 0.08) 0%,
                    transparent 100%
                );
                border-bottom: 1px solid var(--border-subtle);
            }
            .player-skin-3d {
                width: 120px;
                height: 200px;
                margin: 0 auto 1rem;
                image-rendering: pixelated;
                border-radius: 4px;
            }
            .player-detail-name {
                font-family: "Cinzel", serif;
                font-size: 1.3rem;
                font-weight: 700;
                margin-bottom: 0.25rem;
            }
            .player-detail-rank {
                display: inline-flex;
                align-items: center;
                gap: 0.3rem;
                font-size: 0.8rem;
                padding: 0.3rem 0.8rem;
                border-radius: 20px;
            }
            .player-detail-season {
                display: inline-flex;
                align-items: center;
                gap: 0.3rem;
                font-size: 0.75rem;
                padding: 0.25rem 0.7rem;
                border-radius: 20px;
                background: rgba(6, 182, 212, 0.1);
                color: var(--accent-aqua);
                margin-top: 0.5rem;
            }

            .player-detail-body {
                padding: 1.25rem;
                flex: 1;
                overflow-y: auto;
            }

            .detail-section {
                margin-bottom: 1.25rem;
            }
            .detail-section-title {
                font-size: 0.75rem;
                text-transform: uppercase;
                letter-spacing: 0.1em;
                color: var(--text-muted);
                font-weight: 600;
                margin-bottom: 0.6rem;
                display: flex;
                align-items: center;
                gap: 0.4rem;
            }
            .detail-section-title i {
                color: var(--accent-aqua);
                font-size: 0.7rem;
            }

            .detail-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 0.45rem 0;
                font-size: 0.85rem;
            }
            .detail-label {
                color: var(--text-muted);
            }
            .detail-value {
                color: var(--text-primary);
                font-weight: 500;
                font-family: "JetBrains Mono", monospace;
                font-size: 0.8rem;
            }

            .detail-alt-names {
                display: flex;
                flex-wrap: wrap;
                gap: 0.3rem;
                margin-top: 0.4rem;
            }
            .alt-name-tag {
                font-size: 0.72rem;
                padding: 0.2rem 0.5rem;
                border-radius: 4px;
                background: rgba(255, 255, 255, 0.05);
                color: var(--text-secondary);
                font-family: "JetBrains Mono", monospace;
            }

            /* Sanction History */
            .sanction-list {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
            .sanction-item {
                padding: 0.6rem 0.75rem;
                background: rgba(0, 0, 0, 0.2);
                border-radius: 8px;
                border-left: 3px solid var(--accent-red);
                font-size: 0.8rem;
            }
            .sanction-item.kick {
                border-left-color: var(--accent-yellow);
            }
            .sanction-item.mute {
                border-left-color: var(--accent-orange);
            }
            .sanction-item.tempban {
                border-left-color: var(--accent-red);
            }
            .sanction-item.ban {
                border-left-color: #dc2626;
            }

            .sanction-type {
                font-weight: 600;
                text-transform: uppercase;
                font-size: 0.7rem;
                letter-spacing: 0.05em;
            }
            .sanction-reason {
                color: var(--text-secondary);
                margin-top: 0.2rem;
            }
            .sanction-meta {
                color: var(--text-muted);
                font-size: 0.72rem;
                margin-top: 0.2rem;
            }

            .no-sanctions {
                color: var(--text-muted);
                font-size: 0.85rem;
                font-style: italic;
                padding: 0.5rem 0;
            }

            /* ═══════════════════════════════════════════════════════
           ANNONCE DISCORD TAB
           ═══════════════════════════════════════════════════════ */
            .announce-container {
                max-width: 800px;
                margin: 0 auto;
            }

            .announce-header {
                text-align: center;
                margin-bottom: 2rem;
            }
            .announce-title {
                font-family: "Cinzel", serif;
                font-size: 1.8rem;
                font-weight: 700;
            }
            .announce-title span {
                color: var(--accent-aqua);
            }
            .announce-subtitle {
                color: var(--text-muted);
                font-size: 0.95rem;
                margin-top: 0.5rem;
            }
            .announce-user-badge {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                background: var(--accent-aqua-subtle);
                border: 1px solid var(--border-aqua);
                padding: 0.4rem 0.9rem;
                border-radius: 20px;
                font-size: 0.85rem;
                color: var(--accent-aqua);
                margin-top: 0.75rem;
            }

            .announcement-form {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 16px;
                padding: 2rem;
            }
            .form-section {
                margin-bottom: 1.5rem;
            }
            .form-section-title {
                font-size: 1rem;
                font-weight: 600;
                margin-bottom: 0.75rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .form-section-title i {
                color: var(--accent-aqua);
            }

            .title-input,
            .description-textarea {
                width: 100%;
                padding: 0.9rem 1.15rem;
                background: var(--bg-input);
                border: 1px solid var(--border-subtle);
                border-radius: 10px;
                color: var(--text-primary);
                font-family: "Outfit", sans-serif;
                font-size: 1rem;
                transition: all 0.3s ease;
                outline: none;
            }
            .title-input:focus,
            .description-textarea:focus {
                border-color: var(--accent-aqua);
                box-shadow: 0 0 0 3px var(--accent-aqua-glow);
            }
            .description-textarea {
                min-height: 140px;
                resize: vertical;
                line-height: 1.6;
            }

            .markdown-hint {
                font-size: 0.8rem;
                color: var(--text-muted);
                margin-top: 0.5rem;
            }
            .markdown-hint code {
                background: rgba(0, 0, 0, 0.3);
                padding: 0.15rem 0.4rem;
                border-radius: 4px;
                font-size: 0.75rem;
            }

            .image-upload-zone {
                border: 2px dashed var(--border-subtle);
                border-radius: 12px;
                padding: 2rem;
                text-align: center;
                cursor: pointer;
                position: relative;
                transition: all 0.3s ease;
            }
            .image-upload-zone:hover,
            .image-upload-zone.dragover {
                border-color: var(--accent-aqua);
                background: rgba(6, 182, 212, 0.05);
            }
            .image-upload-zone input[type="file"] {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                opacity: 0;
                cursor: pointer;
            }
            .upload-icon {
                font-size: 2.5rem;
                color: var(--text-muted);
                margin-bottom: 0.75rem;
            }
            .upload-text {
                color: var(--text-secondary);
                margin-bottom: 0.25rem;
            }
            .upload-hint {
                color: var(--text-muted);
                font-size: 0.8rem;
            }

            .image-preview-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 0.75rem;
                margin-top: 1rem;
            }
            .image-preview-item {
                position: relative;
                aspect-ratio: 16/9;
                border-radius: 8px;
                overflow: hidden;
                background: rgba(0, 0, 0, 0.3);
            }
            .image-preview-item img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }
            .image-remove-btn {
                position: absolute;
                top: 6px;
                right: 6px;
                width: 26px;
                height: 26px;
                background: rgba(239, 68, 68, 0.9);
                border: none;
                border-radius: 6px;
                color: white;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.7rem;
            }

            .signature-section {
                display: flex;
                align-items: center;
                gap: 0.75rem;
                padding: 0.9rem;
                background: rgba(0, 0, 0, 0.2);
                border-radius: 10px;
            }
            .checkbox-wrapper input[type="checkbox"] {
                width: 20px;
                height: 20px;
                accent-color: var(--accent-aqua);
                cursor: pointer;
            }
            .signature-label {
                color: var(--text-secondary);
                font-size: 0.95rem;
            }
            .signature-label strong {
                color: var(--accent-aqua);
            }

            .action-buttons {
                display: flex;
                gap: 1rem;
                margin-top: 1.5rem;
            }
            .btn-reset {
                flex: 1;
                padding: 0.9rem;
                background: rgba(239, 68, 68, 0.1);
                border: 1px solid rgba(239, 68, 68, 0.3);
                border-radius: 10px;
                color: #fca5a5;
                font-family: "Outfit", sans-serif;
                font-size: 0.95rem;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.5rem;
                transition: all 0.2s ease;
            }
            .btn-reset:hover {
                background: rgba(239, 68, 68, 0.2);
            }

            .btn-confirm {
                flex: 1;
                padding: 0.9rem;
                background: linear-gradient(
                    135deg,
                    var(--accent-green),
                    #059669
                );
                border: none;
                border-radius: 10px;
                color: white;
                font-family: "Outfit", sans-serif;
                font-size: 0.95rem;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.5rem;
                transition: all 0.2s ease;
            }
            .btn-confirm:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
            }

            /* Preview overlay */
            .preview-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(8px);
                z-index: 5000;
                display: flex;
                align-items: center;
                justify-content: center;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                overflow-y: auto;
                padding: 2rem;
            }
            .preview-overlay.active {
                opacity: 1;
                visibility: visible;
            }

            .preview-modal {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 16px;
                width: 100%;
                max-width: 700px;
                max-height: 90vh;
                overflow-y: auto;
                transform: scale(0.9);
                transition: all 0.3s ease;
            }
            .preview-overlay.active .preview-modal {
                transform: scale(1);
            }

            .preview-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 1.25rem 1.5rem;
                border-bottom: 1px solid var(--border-subtle);
                position: sticky;
                top: 0;
                background: var(--bg-card);
                z-index: 1;
            }
            .preview-title {
                font-family: "Cinzel", serif;
                font-size: 1.2rem;
                font-weight: 600;
            }
            .preview-close {
                width: 36px;
                height: 36px;
                border: none;
                background: rgba(255, 255, 255, 0.05);
                border-radius: 8px;
                color: var(--text-muted);
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.2s ease;
            }
            .preview-close:hover {
                background: rgba(255, 255, 255, 0.1);
                color: var(--text-primary);
            }

            .preview-content {
                padding: 1.5rem;
            }
            .discord-preview {
                background: var(--discord-bg);
                border-radius: 8px;
                padding: 1rem;
            }
            .discord-message {
                display: flex;
                gap: 1rem;
            }
            .discord-avatar {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: linear-gradient(
                    135deg,
                    var(--accent-aqua),
                    var(--accent-blue)
                );
                flex-shrink: 0;
            }
            .discord-body {
                flex: 1;
            }
            .discord-header-msg {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                margin-bottom: 0.5rem;
            }
            .discord-username {
                font-weight: 600;
                color: var(--accent-aqua);
            }
            .discord-timestamp {
                font-size: 0.75rem;
                color: var(--text-muted);
            }
            .discord-embed {
                background: transparent;
                padding: 0;
                margin-top: 0.25rem;
            }
            .discord-message-text {
                color: var(--text-primary);
                font-size: 0.95rem;
                line-height: 1.5;
                white-space: pre-wrap;
            }
            .discord-message-text .mention {
                background: rgba(88, 101, 242, 0.3);
                color: #c9cdfb;
                padding: 0 2px;
                border-radius: 3px;
            }
            .discord-message-text .heading {
                font-size: 1.5rem;
                font-weight: 700;
                margin: 0.25rem 0;
                display: block;
            }
            .discord-message-text .signature {
                font-style: italic;
                color: var(--text-muted);
            }
            .discord-embed-images {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
                margin-top: 0.75rem;
            }
            .discord-embed-images.single {
                grid-template-columns: 1fr;
            }
            .discord-embed-images img {
                width: 100%;
                border-radius: 4px;
                max-height: 200px;
                object-fit: cover;
            }

            .channel-selection {
                padding: 1.5rem;
                border-top: 1px solid var(--border-subtle);
            }
            .channel-label {
                font-size: 0.9rem;
                font-weight: 500;
                color: var(--text-secondary);
                margin-bottom: 1rem;
                text-align: center;
            }
            .channel-buttons {
                display: flex;
                gap: 1rem;
            }
            .channel-btn {
                flex: 1;
                padding: 1rem;
                background: rgba(0, 0, 0, 0.3);
                border: 2px solid var(--border-subtle);
                border-radius: 10px;
                color: var(--text-secondary);
                font-family: "Outfit", sans-serif;
                font-size: 0.95rem;
                font-weight: 500;
                cursor: pointer;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 0.5rem;
                transition: all 0.3s ease;
            }
            .channel-btn i {
                font-size: 1.5rem;
            }
            .channel-btn:hover {
                background: rgba(6, 182, 212, 0.1);
                border-color: var(--accent-aqua);
                color: var(--text-primary);
            }
            .channel-btn.selected {
                background: rgba(6, 182, 212, 0.15);
                border-color: var(--accent-aqua);
                color: var(--accent-aqua);
            }
            .channel-btn.vip i {
                color: #fbbf24;
            }
            .channel-btn.general i {
                color: var(--accent-aqua);
            }
            .channel-note {
                font-size: 0.85rem;
                color: var(--text-muted);
                text-align: center;
                margin-top: 1rem;
                padding: 0.75rem;
                background: rgba(6, 182, 212, 0.1);
                border-radius: 8px;
            }

            .send-section {
                padding: 0 1.5rem 1.5rem;
            }
            .btn-send {
                width: 100%;
                padding: 1.15rem;
                background: linear-gradient(
                    135deg,
                    var(--accent-aqua),
                    var(--accent-blue)
                );
                border: none;
                border-radius: 12px;
                color: white;
                font-family: "Outfit", sans-serif;
                font-size: 1.05rem;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.75rem;
                transition: all 0.3s ease;
            }
            .btn-send:hover:not(:disabled) {
                transform: translateY(-2px);
                box-shadow: 0 8px 30px var(--accent-aqua-glow);
            }
            .btn-send:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .success-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                z-index: 6000;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
            }
            .success-overlay.active {
                opacity: 1;
                visibility: visible;
            }
            .success-icon {
                width: 100px;
                height: 100px;
                background: rgba(16, 185, 129, 0.2);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 1.5rem;
            }
            .success-icon i {
                font-size: 3rem;
                color: var(--accent-green);
            }
            .success-title {
                font-family: "Cinzel", serif;
                font-size: 1.75rem;
                margin-bottom: 0.5rem;
            }
            .success-subtitle {
                color: var(--text-muted);
                font-size: 1rem;
            }

            /* ═══════════════════════════════════════════════════════
           COMMANDES TAB
           ═══════════════════════════════════════════════════════ */
            .commandes-container {
                max-width: 900px;
                margin: 0 auto;
            }

            .commandes-header {
                text-align: center;
                margin-bottom: 2rem;
            }
            .commandes-title {
                font-family: "Cinzel", serif;
                font-size: 1.8rem;
                font-weight: 700;
            }
            .commandes-title span {
                color: var(--accent-aqua);
            }

            .cmd-tabs {
                display: flex;
                gap: 0.75rem;
                margin-bottom: 2rem;
                flex-wrap: wrap;
            }
            .cmd-tab-btn {
                padding: 0.7rem 1.25rem;
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 10px;
                color: var(--text-secondary);
                font-family: "Outfit", sans-serif;
                font-size: 0.9rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.25s ease;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .cmd-tab-btn:hover {
                border-color: var(--border-aqua);
                color: var(--text-primary);
            }
            .cmd-tab-btn.active {
                background: rgba(6, 182, 212, 0.1);
                border-color: var(--accent-aqua);
                color: var(--accent-aqua);
            }
            .cmd-tab-btn i {
                font-size: 0.9rem;
            }

            .cmd-panel {
                display: none;
            }
            .cmd-panel.active {
                display: block;
                animation: fadeIn 0.3s ease;
            }

            .cmd-group {
                margin-bottom: 1.5rem;
            }
            .cmd-group-title {
                font-size: 0.95rem;
                font-weight: 600;
                color: var(--text-primary);
                margin-bottom: 0.75rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .cmd-group-title i {
                color: var(--accent-aqua);
            }

            .cmd-item {
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                border-radius: 10px;
                padding: 1rem 1.25rem;
                margin-bottom: 0.5rem;
                transition: all 0.2s ease;
            }
            .cmd-item:hover {
                border-color: var(--border-aqua);
            }

            .cmd-syntax {
                font-family: "JetBrains Mono", monospace;
                font-size: 0.85rem;
                color: var(--accent-aqua);
                background: rgba(6, 182, 212, 0.08);
                padding: 0.35rem 0.7rem;
                border-radius: 6px;
                display: inline-block;
                margin-bottom: 0.5rem;
            }
            .cmd-desc {
                font-size: 0.85rem;
                color: var(--text-secondary);
                line-height: 1.5;
            }

            /* ═══════════════════════════════════════════════════════
           BOTTOM DOCK (ReactBits style)
           ═══════════════════════════════════════════════════════ */
            .dock-wrapper {
                position: fixed;
                bottom: 0;
                left: var(--sidebar-width);
                right: 0;
                display: flex;
                justify-content: center;
                padding-bottom: 12px;
                z-index: 100;
                pointer-events: none;
            }

            .dock {
                display: flex;
                align-items: flex-end;
                gap: 4px;
                padding: 8px 10px;
                pointer-events: all;
                background: rgba(17, 24, 39, 0.85);
                backdrop-filter: blur(16px);
                border: 1px solid var(--border-subtle);
                border-radius: 18px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            }

            .dock-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
                cursor: pointer;
                transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                padding: 6px;
                border-radius: 12px;
                position: relative;
            }
            .dock-item:hover {
                background: rgba(255, 255, 255, 0.06);
            }
            .dock-item.active {
                background: rgba(6, 182, 212, 0.12);
            }
            .dock-item.active::after {
                content: "";
                position: absolute;
                bottom: 0px;
                width: 5px;
                height: 5px;
                border-radius: 50%;
                background: var(--accent-aqua);
            }

            .dock-icon {
                width: 44px;
                height: 44px;
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.2rem;
                transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                transform-origin: bottom center;
            }
            .dock-icon.minijeu {
                background: linear-gradient(135deg, #f59e0b, #ef4444);
                color: white;
            }
            .dock-icon.smp {
                background: linear-gradient(
                    135deg,
                    var(--accent-aqua),
                    var(--accent-blue)
                );
                color: white;
            }
            .dock-icon.whitelist {
                background: linear-gradient(
                    135deg,
                    var(--accent-green),
                    #059669
                );
                color: white;
            }

            .dock-label {
                font-size: 0.6rem;
                color: var(--text-muted);
                font-weight: 500;
                letter-spacing: 0.02em;
                transition: all 0.2s ease;
                white-space: nowrap;
            }

            /* Dock magnification */
            .dock-item.magnify-1 .dock-icon {
                transform: scale(1.25);
            }
            .dock-item.magnify-2 .dock-icon {
                transform: scale(1.5);
            }
            .dock-item.magnify-1 {
                margin: 0 2px;
            }
            .dock-item.magnify-2 {
                margin: 0 4px;
            }

            .dock-tooltip {
                position: absolute;
                top: -36px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--bg-card);
                border: 1px solid var(--border-subtle);
                color: var(--text-primary);
                padding: 0.3rem 0.7rem;
                border-radius: 8px;
                font-size: 0.75rem;
                font-weight: 600;
                white-space: nowrap;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.15s ease;
            }
            .dock-item:hover .dock-tooltip {
                opacity: 1;
            }

            /* ═══════════════════════════════════════════════════════
           STATUS BADGES
           ═══════════════════════════════════════════════════════ */
            .status-badge {
                display: inline-flex;
                align-items: center;
                gap: 0.3rem;
                font-size: 0.72rem;
                font-weight: 600;
                padding: 0.2rem 0.6rem;
                border-radius: 20px;
            }
            .status-online {
                background: rgba(16, 185, 129, 0.15);
                color: var(--accent-green);
            }
            .status-offline {
                background: rgba(239, 68, 68, 0.15);
                color: var(--accent-red);
            }

            /* ═══════════════════════════════════════════════════════
           RESPONSIVE
           ═══════════════════════════════════════════════════════ */
            @media (max-width: 1100px) {
                .dashboard-grid {
                    grid-template-columns: 1fr;
                }
                .joueurs-layout {
                    grid-template-columns: 1fr;
                }
                .joueurs-layout .player-detail {
                    max-height: 400px;
                }
            }
            @media (max-width: 768px) {
                .sidebar {
                    width: 60px;
                }
                .sidebar-brand,
                .sidebar-label,
                .sidebar-item span,
                .sidebar-username,
                .sidebar-userrole {
                    display: none;
                }
                .sidebar-header {
                    padding: 1rem 0.6rem;
                    justify-content: center;
                }
                .sidebar-item {
                    padding: 0.75rem;
                    justify-content: center;
                }
                .sidebar-user {
                    padding: 0.75rem;
                    justify-content: center;
                }
                .dock-wrapper {
                    left: 60px;
                }
                .player-row {
                    grid-template-columns: 36px 1fr 60px 60px;
                }
                .player-rank-cell,
                .player-world-cell {
                    display: none;
                }
            }
        </style>
    </head>
    <body>
        <!-- Background -->
        <div class="bg-pattern"></div>
        <div class="particles" id="particles"></div>

        <!-- ═══════════════════════════════════════════════════════
     LOGIN SCREEN
     ═══════════════════════════════════════════════════════ -->
        <div class="login-overlay" id="loginOverlay">
            <div class="login-card">
                <div class="login-logo">
                    <img
                        src="icons/logo.png"
                        alt="True Vanilla"
                        onerror="this.style.display = 'none'"
                    />
                    <div class="login-logo-text">True Vanilla</div>
                </div>
                <p class="login-subtitle">
                    Panneau d'Administration — Accès restreint
                </p>

                <button
                    class="discord-login-btn"
                    id="discordLoginBtn"
                    onclick="loginWithDiscord()"
                >
                    <i class="fab fa-discord"></i> Se connecter avec Discord
                </button>

                <div class="login-error" id="loginError">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="loginErrorMsg"
                        >Accès refusé. Vous n'êtes pas autorisé.</span
                    >
                </div>

                <div class="login-badge">
                    <i class="fas fa-lock"></i> Réservé aux administrateurs
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════
     APP CONTAINER
     ═══════════════════════════════════════════════════════ -->
        <div class="app-container" id="appContainer">
            <!-- SIDEBAR -->
            <nav class="sidebar">
                <div class="sidebar-header">
                    <img
                        src="icons/logo.png"
                        alt=""
                        class="sidebar-logo"
                        onerror="this.style.display = 'none'"
                    />
                    <div class="sidebar-brand">
                        Admin Panel
                        <small>True Vanilla</small>
                    </div>
                </div>

                <div class="sidebar-nav">
                    <div class="sidebar-label">Navigation</div>
                    <div
                        class="sidebar-item active"
                        data-tab="dashboard"
                        onclick="switchTab('dashboard')"
                    >
                        <i class="fas fa-chart-line"></i> <span>Dashboard</span>
                    </div>
                    <div
                        class="sidebar-item"
                        data-tab="joueurs"
                        onclick="switchTab('joueurs')"
                    >
                        <i class="fas fa-users"></i> <span>Joueurs</span>
                    </div>
                    <div
                        class="sidebar-item"
                        data-tab="annonce"
                        onclick="switchTab('annonce')"
                    >
                        <i class="fab fa-discord"></i>
                        <span>Annonce Discord</span>
                    </div>
                    <div
                        class="sidebar-item"
                        data-tab="commandes"
                        onclick="switchTab('commandes')"
                    >
                        <i class="fas fa-terminal"></i>
                        <span>Liste de Commandes</span>
                    </div>
                </div>

                <div class="sidebar-user">
                    <img
                        src=""
                        alt=""
                        class="sidebar-avatar"
                        id="sidebarAvatar"
                        onerror="
                            this.style.background =
                                'linear-gradient(135deg, var(--accent-aqua), var(--accent-blue))';
                            this.style.display = 'block';
                        "
                    />
                    <div>
                        <div class="sidebar-username" id="sidebarUsername">
                            Admin
                        </div>
                        <div class="sidebar-userrole">Administrateur</div>
                    </div>
                    <button
                        class="sidebar-logout"
                        onclick="logout()"
                        title="Déconnexion"
                    >
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </nav>

            <!-- MAIN AREA -->
            <div class="main-area">
                <!-- Server Top Bar -->
                <div class="server-bar">
                    <div class="server-bar-left">
                        <div class="server-indicator">
                            <span class="server-dot" id="serverDot"></span>
                            <span
                                class="server-name-label"
                                id="currentServerName"
                                >SMP</span
                            >
                        </div>
                        <span
                            class="status-badge status-online"
                            id="serverStatus"
                            >En ligne</span
                        >
                    </div>
                    <div class="server-bar-right">
                        <div class="stat-chip">
                            <i class="fas fa-microchip"></i> CPU:
                            <span class="val" id="topCpu">0%</span>
                        </div>
                        <div class="stat-chip">
                            <i class="fas fa-memory"></i> RAM:
                            <span class="val" id="topRam">0 MB</span>
                        </div>
                        <div class="stat-chip">
                            <i class="fas fa-users"></i>
                            <span class="val" id="topPlayers">0</span> joueurs
                        </div>
                    </div>
                </div>

                <!-- Scrollable content -->
                <div class="content-scroll">
                    <!-- ═══ DASHBOARD ═══ -->
                    <div class="tab-panel active" id="tab-dashboard">
                        <div class="dashboard-grid">
                            <!-- Console Panel -->
                            <div class="panel">
                                <div class="panel-header">
                                    <div class="panel-title">
                                        <i class="fas fa-terminal"></i> Console
                                        Serveur
                                    </div>
                                    <div
                                        class="console-ip"
                                        onclick="copyIP()"
                                        title="Copier l'IP"
                                    >
                                        <i class="fas fa-server"></i>
                                        <span id="serverIP"
                                            >play.true-vanilla.fr</span
                                        >
                                    </div>
                                </div>
                                <div class="console-body" id="consoleBody">
                                    <div class="console-line">
                                        <span class="time">[--:--:--]</span>
                                        <span class="info">[INFO]</span> En
                                        attente de connexion au serveur...
                                    </div>
                                </div>
                                <div class="console-input-bar">
                                    <input
                                        type="text"
                                        class="console-input"
                                        id="consoleInput"
                                        placeholder="Entrer une commande..."
                                        onkeydown="
                                            if (event.key === 'Enter')
                                                sendCommand();
                                        "
                                    />
                                    <button
                                        class="console-send"
                                        onclick="sendCommand()"
                                    >
                                        <i class="fas fa-paper-plane"></i>
                                        Envoyer
                                    </button>
                                </div>
                            </div>

                            <!-- Stats Column -->
                            <div class="stats-column">
                                <div class="stat-card">
                                    <div class="stat-card-header">
                                        <span class="stat-card-label"
                                            >Utilisation CPU</span
                                        >
                                        <div class="stat-card-icon cpu">
                                            <i class="fas fa-microchip"></i>
                                        </div>
                                    </div>
                                    <div class="stat-card-value" id="cpuValue">
                                        0<small>%</small>
                                    </div>
                                    <div class="stat-bar-track">
                                        <div
                                            class="stat-bar-fill cpu-fill"
                                            id="cpuBar"
                                            style="width: 0%"
                                        ></div>
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-card-header">
                                        <span class="stat-card-label"
                                            >Mémoire RAM</span
                                        >
                                        <div class="stat-card-icon ram">
                                            <i class="fas fa-memory"></i>
                                        </div>
                                    </div>
                                    <div class="stat-card-value" id="ramValue">
                                        0<small> MB</small>
                                    </div>
                                    <div class="stat-bar-track">
                                        <div
                                            class="stat-bar-fill ram-fill"
                                            id="ramBar"
                                            style="width: 0%"
                                        ></div>
                                    </div>
                                </div>

                                <div
                                    class="stat-card players-stat-card"
                                    onclick="switchTab('joueurs')"
                                >
                                    <div class="stat-card-header">
                                        <span class="stat-card-label"
                                            >Joueurs en ligne</span
                                        >
                                        <div class="stat-card-icon players">
                                            <i class="fas fa-users"></i>
                                        </div>
                                    </div>
                                    <div
                                        class="stat-card-value"
                                        id="playerCountValue"
                                    >
                                        0
                                    </div>
                                    <div
                                        class="player-count-list"
                                        id="playerCountList"
                                    >
                                        <span
                                            style="
                                                font-size: 0.8rem;
                                                color: var(--text-muted);
                                            "
                                            >Aucun joueur connecté</span
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ═══ JOUEURS ═══ -->
                    <div class="tab-panel" id="tab-joueurs">
                        <div
                            class="joueurs-layout no-selection"
                            id="joueursLayout"
                        >
                            <div class="player-list-panel">
                                <div class="player-search-bar">
                                    <div class="player-search-wrap">
                                        <i class="fas fa-search"></i>
                                        <input
                                            type="text"
                                            class="player-search"
                                            id="playerSearchInput"
                                            placeholder="Rechercher un joueur..."
                                            oninput="filterPlayers()"
                                        />
                                    </div>
                                </div>
                                <div class="player-grid" id="playerGrid">
                                    <div
                                        style="
                                            text-align: center;
                                            padding: 3rem;
                                            color: var(--text-muted);
                                        "
                                    >
                                        <i
                                            class="fas fa-users"
                                            style="
                                                font-size: 2rem;
                                                margin-bottom: 1rem;
                                                display: block;
                                                opacity: 0.3;
                                            "
                                        ></i>
                                        En attente de connexion au serveur...
                                    </div>
                                </div>
                            </div>
                            <div
                                class="player-detail"
                                id="playerDetail"
                                style="display: none"
                            >
                                <!-- filled dynamically -->
                            </div>
                        </div>
                    </div>

                    <!-- ═══ ANNONCE DISCORD ═══ -->
                    <div class="tab-panel" id="tab-annonce">
                        <div class="announce-container">
                            <div class="announce-header">
                                <h1 class="announce-title">
                                    Créer une <span>Annonce</span>
                                </h1>
                                <p class="announce-subtitle">
                                    Publiez une annonce sur Discord (elle
                                    apparaîtra automatiquement sur le site)
                                </p>
                                <div class="announce-user-badge">
                                    <i class="fas fa-user-shield"></i>
                                    <span id="announceUsername">-</span>
                                </div>
                            </div>
                            <div class="announcement-form">
                                <div class="form-section">
                                    <div class="form-section-title">
                                        <i class="fas fa-heading"></i> Titre
                                    </div>
                                    <input
                                        type="text"
                                        class="title-input"
                                        id="announcementTitle"
                                        placeholder="Titre de l'annonce..."
                                        maxlength="100"
                                    />
                                </div>
                                <div class="form-section">
                                    <div class="form-section-title">
                                        <i class="fas fa-align-left"></i>
                                        Description
                                    </div>
                                    <textarea
                                        class="description-textarea"
                                        id="announcementDescription"
                                        placeholder="Description de l'annonce..."
                                    ></textarea>
                                    <p class="markdown-hint">
                                        Markdown : <code>**gras**</code>
                                        <code>*italique*</code>
                                        <code>__souligné__</code>
                                        <code>~~barré~~</code>
                                    </p>
                                </div>
                                <div class="form-section">
                                    <div class="form-section-title">
                                        <i class="fas fa-images"></i> Images (4
                                        max)
                                    </div>
                                    <div
                                        class="image-upload-zone"
                                        id="uploadZone"
                                    >
                                        <input
                                            type="file"
                                            id="imageInput"
                                            accept="image/*"
                                            multiple
                                        />
                                        <div class="upload-icon">
                                            <i
                                                class="fas fa-cloud-upload-alt"
                                            ></i>
                                        </div>
                                        <p class="upload-text">
                                            Glissez, cliquez ou collez
                                        </p>
                                        <p class="upload-hint">
                                            PNG, JPG, GIF (50MB max)
                                        </p>
                                    </div>
                                    <div
                                        class="image-preview-grid"
                                        id="imagePreviewGrid"
                                    ></div>
                                </div>
                                <div class="form-section">
                                    <div class="form-section-title">
                                        <i class="fas fa-signature"></i>
                                        Signature
                                    </div>
                                    <div class="signature-section">
                                        <div class="checkbox-wrapper">
                                            <input
                                                type="checkbox"
                                                id="signatureCheckbox"
                                            />
                                        </div>
                                        <label
                                            class="signature-label"
                                            for="signatureCheckbox"
                                            >Signer en tant que
                                            <strong id="signatureName"
                                                >-</strong
                                            ></label
                                        >
                                    </div>
                                </div>
                                <div class="action-buttons">
                                    <button class="btn-reset" id="btnReset">
                                        <i class="fas fa-undo"></i>
                                        Réinitialiser
                                    </button>
                                    <button class="btn-confirm" id="btnConfirm">
                                        <i class="fas fa-eye"></i> Aperçu
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ═══ LISTE DE COMMANDES ═══ -->
                    <div class="tab-panel" id="tab-commandes">
                        <div class="commandes-container">
                            <div class="commandes-header">
                                <h1 class="commandes-title">
                                    Liste des <span>Commandes</span>
                                </h1>
                            </div>

                            <div class="cmd-tabs">
                                <button
                                    class="cmd-tab-btn active"
                                    onclick="switchCmdTab('sanctions')"
                                >
                                    <i class="fas fa-gavel"></i> Sanctions
                                </button>
                                <button
                                    class="cmd-tab-btn"
                                    onclick="switchCmdTab('permissions')"
                                >
                                    <i class="fas fa-key"></i>
                                    Permissions/Grades
                                </button>
                                <button
                                    class="cmd-tab-btn"
                                    onclick="switchCmdTab('remboursements')"
                                >
                                    <i class="fas fa-undo-alt"></i>
                                    Remboursements
                                </button>
                                <button
                                    class="cmd-tab-btn"
                                    onclick="switchCmdTab('grief')"
                                >
                                    <i class="fas fa-search-location"></i> Grief
                                </button>
                            </div>

                            <!-- SANCTIONS (AdvancedBan) -->
                            <div class="cmd-panel active" id="cmd-sanctions">
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-ban"></i> Bannissements
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ban &lt;joueur&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Bannit définitivement un joueur du
                                            serveur. Le joueur ne pourra plus se
                                            connecter tant qu'il n'est pas
                                            débanni. Utilisé pour les
                                            infractions graves (triche,
                                            harcèlement répété, etc.).
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /tempban &lt;joueur&gt;
                                            &lt;durée&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Bannit temporairement un joueur pour
                                            une durée définie (ex: 1d = 1 jour,
                                            2h = 2 heures, 30m = 30 minutes).
                                            Idéal pour les premières infractions
                                            ou sanctions progressives.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /unban &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Retire le bannissement d'un joueur,
                                            lui permettant de se reconnecter au
                                            serveur. Utilisé après une révision
                                            de sanction ou en cas d'erreur.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /banip &lt;joueur&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Bannit l'adresse IP d'un joueur.
                                            Empêche toute connexion depuis cette
                                            IP, même avec un autre compte. Utile
                                            contre les contournements de ban.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /tempbanip &lt;joueur&gt;
                                            &lt;durée&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Bannit temporairement l'adresse IP
                                            d'un joueur pour la durée spécifiée.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /unbanip &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Retire le bannissement IP d'un
                                            joueur.
                                        </div>
                                    </div>
                                </div>
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-volume-mute"></i> Mutes
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /mute &lt;joueur&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Rend un joueur muet définitivement
                                            dans le chat. Il ne pourra plus
                                            envoyer de messages. Utilisé pour le
                                            spam, insultes, ou comportements
                                            toxiques répétés.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /tempmute &lt;joueur&gt;
                                            &lt;durée&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Rend un joueur muet temporairement
                                            pour la durée spécifiée. Parfait
                                            pour les premiers avertissements
                                            liés au chat.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /unmute &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Retire le mute d'un joueur, lui
                                            permettant de reparler dans le chat.
                                        </div>
                                    </div>
                                </div>
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-shoe-prints"></i> Kicks
                                        & Historique
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /kick &lt;joueur&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Expulse un joueur du serveur. Il
                                            pourra se reconnecter immédiatement.
                                            Utilisé comme avertissement ou pour
                                            résoudre un problème technique.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /history &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Affiche l'historique complet des
                                            sanctions d'un joueur (bans, mutes,
                                            kicks). Permet de voir si un joueur
                                            est récidiviste avant de
                                            sanctionner.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /warns &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Affiche les avertissements actifs
                                            d'un joueur.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /warn &lt;joueur&gt; &lt;raison&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Donne un avertissement officiel à un
                                            joueur. Les warns sont comptabilisés
                                            et peuvent mener à des sanctions
                                            automatiques.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /unwarn &lt;joueur&gt; &lt;id&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Supprime un avertissement spécifique
                                            d'un joueur via son ID.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- PERMISSIONS/GRADES (LuckPerms) -->
                            <div class="cmd-panel" id="cmd-permissions">
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-user-tag"></i> Gestion
                                        des Groupes
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; parent set
                                            &lt;groupe&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Définit le groupe principal d'un
                                            joueur (ex: vip, modo, admin).
                                            Remplace le groupe actuel. C'est la
                                            commande la plus utilisée pour
                                            changer le rang d'un joueur.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; parent add
                                            &lt;groupe&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Ajoute un groupe supplémentaire à un
                                            joueur sans retirer son groupe
                                            actuel. Utile pour cumuler des
                                            permissions de plusieurs groupes.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; parent
                                            remove &lt;groupe&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Retire un groupe spécifique d'un
                                            joueur. Le joueur conserve ses
                                            autres groupes.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; info
                                        </div>
                                        <div class="cmd-desc">
                                            Affiche toutes les informations d'un
                                            joueur : groupes, permissions,
                                            préfixes, suffixes et métadonnées.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; parent
                                            settrack &lt;track&gt;
                                            &lt;groupe&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Définit le groupe d'un joueur sur un
                                            track de promotion spécifique
                                            (système de progression de grades).
                                        </div>
                                    </div>
                                </div>
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-key"></i> Gestion des
                                        Permissions
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; permission
                                            set &lt;permission&gt; true
                                        </div>
                                        <div class="cmd-desc">
                                            Accorde une permission spécifique à
                                            un joueur. Permet de donner des
                                            accès individuels sans changer de
                                            groupe.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; permission
                                            unset &lt;permission&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Retire une permission spécifique
                                            d'un joueur.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; permission
                                            set &lt;permission&gt; false
                                        </div>
                                        <div class="cmd-desc">
                                            Refuse explicitement une permission
                                            à un joueur, même si son groupe la
                                            possède. Utile pour restreindre un
                                            joueur spécifique.
                                        </div>
                                    </div>
                                </div>
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-tags"></i> Préfixes &
                                        Suffixes
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; meta
                                            setprefix &lt;priorité&gt;
                                            "&lt;préfixe&gt;"
                                        </div>
                                        <div class="cmd-desc">
                                            Définit un préfixe personnalisé pour
                                            un joueur (affiché avant le nom dans
                                            le chat). La priorité détermine quel
                                            préfixe s'affiche si plusieurs sont
                                            définis.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp user &lt;joueur&gt; meta
                                            setsuffix &lt;priorité&gt;
                                            "&lt;suffixe&gt;"
                                        </div>
                                        <div class="cmd-desc">
                                            Définit un suffixe personnalisé pour
                                            un joueur (affiché après le nom dans
                                            le chat).
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /lp group &lt;groupe&gt; permission
                                            set &lt;permission&gt; true
                                        </div>
                                        <div class="cmd-desc">
                                            Ajoute une permission à un groupe
                                            entier. Tous les membres du groupe
                                            auront automatiquement cette
                                            permission.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">/lp editor</div>
                                        <div class="cmd-desc">
                                            Ouvre l'éditeur web interactif de
                                            LuckPerms. Permet de gérer
                                            visuellement toutes les permissions,
                                            groupes et joueurs depuis un
                                            navigateur.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- REMBOURSEMENTS (InventoryRollbackPlus) -->
                            <div class="cmd-panel" id="cmd-remboursements">
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-box-open"></i>
                                        Restauration d'Inventaire
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ir restore &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Ouvre l'interface de restauration
                                            d'inventaire pour un joueur. Affiche
                                            une liste de sauvegardes avec date
                                            et heure. Permet de visualiser et
                                            restaurer un inventaire passé.
                                            Essentiel pour les remboursements
                                            après un bug ou une perte injuste.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ir restore &lt;joueur&gt;
                                            &lt;id&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Restaure directement une sauvegarde
                                            spécifique de l'inventaire d'un
                                            joueur via son ID. Plus rapide si
                                            vous connaissez déjà la sauvegarde à
                                            restaurer.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ir rollback &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Effectue un rollback complet de
                                            l'inventaire d'un joueur à un état
                                            antérieur. Restaure l'inventaire,
                                            l'enderchest, l'expérience et les
                                            effets de potion.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ir deathlog &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Affiche la liste des morts
                                            enregistrées d'un joueur avec
                                            l'inventaire qu'il avait à chaque
                                            mort. Permet de rembourser les items
                                            perdus lors d'une mort injuste (lag,
                                            bug, etc.).
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ir enderchest &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Ouvre l'interface de restauration
                                            spécifiquement pour l'enderchest
                                            d'un joueur.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /ir forceopen &lt;joueur&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Force l'ouverture de l'inventaire
                                            d'un joueur même s'il est hors
                                            ligne. Permet de vérifier ou
                                            modifier son contenu à distance.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- GRIEF (CoreProtect) -->
                            <div class="cmd-panel" id="cmd-grief">
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-search"></i> Inspection
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co inspect
                                        </div>
                                        <div class="cmd-desc">
                                            Active/désactive le mode inspection.
                                            En mode inspection, cliquez sur
                                            n'importe quel bloc pour voir son
                                            historique complet : qui l'a posé,
                                            cassé, quand, et quelles
                                            interactions ont eu lieu. Outil
                                            principal pour enquêter sur du
                                            grief.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co lookup u:&lt;joueur&gt;
                                            t:&lt;durée&gt; r:&lt;rayon&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Recherche avancée dans les logs.
                                            Paramètres : u: = joueur, t: =
                                            période (ex: t:7d = 7 jours), r: =
                                            rayon en blocs autour de vous, a: =
                                            action (block, container, chat...).
                                            Exemple : /co lookup u:Joueur t:1d
                                            r:10 montre tout ce qu'un joueur a
                                            fait dans un rayon de 10 blocs
                                            pendant les dernières 24h.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co lookup u:&lt;joueur&gt;
                                            t:&lt;durée&gt; a:container
                                        </div>
                                        <div class="cmd-desc">
                                            Recherche spécifiquement les
                                            interactions avec les coffres et
                                            conteneurs. Permet de savoir qui a
                                            pris des items dans un coffre, ce
                                            qui a été retiré/ajouté, et quand.
                                        </div>
                                    </div>
                                </div>
                                <div class="cmd-group">
                                    <div class="cmd-group-title">
                                        <i class="fas fa-undo-alt"></i> Rollback
                                        & Restauration
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co rollback u:&lt;joueur&gt;
                                            t:&lt;durée&gt; r:&lt;rayon&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Annule toutes les actions d'un
                                            joueur dans la zone et la période
                                            spécifiées. Restaure les blocs
                                            cassés, replace les blocs posés par
                                            le griefer, et restaure le contenu
                                            des coffres. La commande anti-grief
                                            la plus puissante.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co restore u:&lt;joueur&gt;
                                            t:&lt;durée&gt; r:&lt;rayon&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            L'inverse du rollback : restaure les
                                            actions d'un joueur qui ont été
                                            annulées. Utilisé si un rollback a
                                            été fait par erreur, ou pour
                                            réappliquer les modifications d'un
                                            joueur.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co rollback u:&lt;joueur&gt;
                                            t:&lt;durée&gt; r:&lt;rayon&gt;
                                            a:block
                                        </div>
                                        <div class="cmd-desc">
                                            Rollback limité aux blocs uniquement
                                            (ignore les interactions avec les
                                            coffres). Utile quand vous voulez
                                            restaurer les constructions sans
                                            toucher aux inventaires des coffres.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co rollback u:&lt;joueur&gt;
                                            t:&lt;durée&gt; r:&lt;rayon&gt;
                                            a:container
                                        </div>
                                        <div class="cmd-desc">
                                            Rollback limité aux conteneurs
                                            uniquement. Restaure les items volés
                                            dans les coffres sans affecter les
                                            blocs alentour.
                                        </div>
                                    </div>
                                    <div class="cmd-item">
                                        <div class="cmd-syntax">
                                            /co purge t:&lt;durée&gt;
                                        </div>
                                        <div class="cmd-desc">
                                            Supprime les anciennes données de
                                            logs pour libérer de l'espace dans
                                            la base de données. Exemple : /co
                                            purge t:90d supprime les données de
                                            plus de 90 jours. ⚠️ Irréversible —
                                            à utiliser avec précaution.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /content-scroll -->
            </div>
            <!-- /main-area -->
        </div>
        <!-- /app-container -->

        <!-- BOTTOM DOCK -->
        <div class="dock-wrapper" id="dockWrapper" style="display: none">
            <div class="dock" id="dock">
                <div
                    class="dock-item active"
                    data-server="minijeu"
                    onclick="switchServer('minijeu')"
                >
                    <div class="dock-tooltip">Mini-jeu</div>
                    <div class="dock-icon minijeu">
                        <i class="fas fa-gamepad"></i>
                    </div>
                    <span class="dock-label">Mini-jeu</span>
                </div>
                <div
                    class="dock-item"
                    data-server="smp"
                    onclick="switchServer('smp')"
                >
                    <div class="dock-tooltip">SMP</div>
                    <div class="dock-icon smp">
                        <i class="fas fa-mountain-sun"></i>
                    </div>
                    <span class="dock-label">SMP</span>
                </div>
                <div
                    class="dock-item"
                    data-server="whitelist"
                    onclick="switchServer('whitelist')"
                >
                    <div class="dock-tooltip">Whitelist</div>
                    <div class="dock-icon whitelist">
                        <i class="fas fa-list-check"></i>
                    </div>
                    <span class="dock-label">Whitelist</span>
                </div>
            </div>
        </div>

        <!-- DISCORD PREVIEW OVERLAY -->
        <div class="preview-overlay" id="previewOverlay">
            <div class="preview-modal">
                <div class="preview-header">
                    <h2 class="preview-title">Aperçu Discord</h2>
                    <button
                        class="preview-close"
                        id="previewClose"
                        onclick="closePreview()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="preview-content">
                    <div class="discord-preview">
                        <div class="discord-message">
                            <div class="discord-avatar"></div>
                            <div class="discord-body">
                                <div class="discord-header-msg">
                                    <span class="discord-username"
                                        >True Vanilla</span
                                    >
                                    <span class="discord-timestamp"
                                        >Aujourd'hui à
                                        <span id="previewTime"
                                            >--:--</span
                                        ></span
                                    >
                                </div>
                                <div class="discord-embed">
                                    <div
                                        class="discord-message-text"
                                        id="previewMessageText"
                                    ></div>
                                    <div
                                        class="discord-embed-images"
                                        id="previewImages"
                                    ></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="channel-selection">
                    <p class="channel-label">Canal de diffusion :</p>
                    <div class="channel-buttons">
                        <button
                            class="channel-btn vip"
                            id="btnVip"
                            onclick="selectChannel('vip')"
                        >
                            <i class="fas fa-crown"></i><span>VIP</span>
                        </button>
                        <button
                            class="channel-btn general"
                            id="btnGeneral"
                            onclick="selectChannel('general')"
                        >
                            <i class="fas fa-bullhorn"></i><span>Général</span>
                        </button>
                    </div>
                    <p class="channel-note">
                        <i class="fas fa-info-circle"></i> Les annonces
                        générales apparaissent automatiquement sur le site via
                        le bot Discord
                    </p>
                </div>
                <div class="send-section">
                    <button
                        class="btn-send"
                        id="btnSend"
                        disabled
                        onclick="sendAnnouncement()"
                    >
                        <i class="fas fa-paper-plane"></i> Envoyer sur Discord
                    </button>
                </div>
            </div>
        </div>

        <!-- SUCCESS OVERLAY -->
        <div class="success-overlay" id="successOverlay">
            <div class="success-icon"><i class="fas fa-check"></i></div>
            <h2 class="success-title">Annonce publiée !</h2>
            <p class="success-subtitle">
                Elle apparaîtra sur le site automatiquement
            </p>
        </div>

        <script>
            // ═══════════════════════════════════════════════════════
            // CONFIGURATION
            // ═══════════════════════════════════════════════════════
            const CONFIG = {
                ALLOWED_IDS: ["217271015892451328", "303167270891290625"],
                DISCORD_CLIENT_ID: "1425143639125786724",
                DISCORD_REDIRECT_URI: "https://staff.true-vanilla.fr/",
                API_BASE: "http://staff.true-vanilla.fr/api",
                WEBHOOKS: {
                    vip: "https://discord.com/api/webhooks/1436719755578052668/BmHB4Dc40iM9eD9mFc3o7dJZ12pGo9rSH-LEweteHLZII84ncSjh9Sy2M4TNsQv01627",
                    general:
                        "https://discord.com/api/webhooks/1431983410179604642/89zUIzYTwJJJx9qm1sGbra0uI7uOFcNOqAaK0XW1ivChbY8ntRPr0woEK3JA8sY1shyw",
                },
                SERVERS: {
                    minijeu: { name: "Mini-jeu", ip: "play.true-vanilla.fr" },
                    smp: { name: "SMP", ip: "play.true-vanilla.fr" },
                    whitelist: {
                        name: "Whitelist",
                        ip: "play.true-vanilla.fr",
                    },
                },
            };

            let currentUser = null;
            let currentServer = "smp";
            let selectedPlayer = null;
            let uploadedImages = [];
            let selectedChannel = null;
            let consolePolling = null;
            let statsPolling = null;

            // ═══════════════════════════════════════════════════════
            // PARTICLES
            // ═══════════════════════════════════════════════════════
            function createParticles() {
                const c = document.getElementById("particles");
                for (let i = 0; i < 30; i++) {
                    const p = document.createElement("div");
                    p.className = "particle";
                    p.style.left = Math.random() * 100 + "%";
                    p.style.animationDelay = Math.random() * 12 + "s";
                    p.style.animationDuration = 8 + Math.random() * 8 + "s";
                    c.appendChild(p);
                }
            }

            // ═══════════════════════════════════════════════════════
            // DISCORD OAUTH LOGIN
            // ═══════════════════════════════════════════════════════
            function loginWithDiscord() {
                const params = new URLSearchParams({
                    client_id: CONFIG.DISCORD_CLIENT_ID,
                    redirect_uri: CONFIG.DISCORD_REDIRECT_URI,
                    response_type: "token",
                    scope: "identify",
                });
                window.location.href =
                    "https://discord.com/api/oauth2/authorize?" +
                    params.toString();
            }

            async function handleOAuthCallback() {
                const fragment = new URLSearchParams(
                    window.location.hash.slice(1),
                );
                const accessToken = fragment.get("access_token");
                if (!accessToken) return false;

                try {
                    const res = await fetch(
                        "https://discord.com/api/users/@me",
                        {
                            headers: { Authorization: "Bearer " + accessToken },
                        },
                    );
                    const user = await res.json();

                    // Clear the hash from URL
                    history.replaceState(null, "", window.location.pathname);

                    if (!CONFIG.ALLOWED_IDS.includes(user.id)) {
                        document
                            .getElementById("loginError")
                            .classList.add("show");
                        document.getElementById("loginErrorMsg").textContent =
                            "Accès refusé. Votre compte Discord n'est pas autorisé.";
                        return false;
                    }

                    currentUser = {
                        id: user.id,
                        username: user.global_name || user.username,
                        avatar: user.avatar
                            ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=128`
                            : null,
                    };

                    sessionStorage.setItem(
                        "tv_admin_user",
                        JSON.stringify(currentUser),
                    );
                    showApp();
                    return true;
                } catch (e) {
                    console.error("OAuth error:", e);
                    document.getElementById("loginError").classList.add("show");
                    document.getElementById("loginErrorMsg").textContent =
                        "Erreur de connexion. Réessayez.";
                    return false;
                }
            }

            function showApp() {
                document.getElementById("loginOverlay").classList.add("hidden");
                document
                    .getElementById("appContainer")
                    .classList.add("visible");
                document.getElementById("dockWrapper").style.display = "flex";

                // Set user info
                document.getElementById("sidebarUsername").textContent =
                    currentUser.username;
                document.getElementById("announceUsername").textContent =
                    currentUser.username;
                document.getElementById("signatureName").textContent =
                    currentUser.username;
                if (currentUser.avatar) {
                    document.getElementById("sidebarAvatar").src =
                        currentUser.avatar;
                }

                startPolling();
                initDock();
            }

            function logout() {
                sessionStorage.removeItem("tv_admin_user");
                currentUser = null;
                stopPolling();
                document
                    .getElementById("appContainer")
                    .classList.remove("visible");
                document.getElementById("dockWrapper").style.display = "none";
                document
                    .getElementById("loginOverlay")
                    .classList.remove("hidden");
                document.getElementById("loginError").classList.remove("show");
            }

            // ═══════════════════════════════════════════════════════
            // TAB SWITCHING
            // ═══════════════════════════════════════════════════════
            function switchTab(tab) {
                document
                    .querySelectorAll(".sidebar-item")
                    .forEach((el) =>
                        el.classList.toggle("active", el.dataset.tab === tab),
                    );
                document
                    .querySelectorAll(".tab-panel")
                    .forEach((el) =>
                        el.classList.toggle("active", el.id === "tab-" + tab),
                    );
            }

            function switchCmdTab(tab) {
                document
                    .querySelectorAll(".cmd-tab-btn")
                    .forEach((el) =>
                        el.classList.toggle(
                            "active",
                            el.textContent
                                .toLowerCase()
                                .includes(tab.substring(0, 4)),
                        ),
                    );
                document
                    .querySelectorAll(".cmd-panel")
                    .forEach((el) =>
                        el.classList.toggle("active", el.id === "cmd-" + tab),
                    );
            }

            // ═══════════════════════════════════════════════════════
            // SERVER SWITCHING (Dock)
            // ═══════════════════════════════════════════════════════
            function switchServer(server) {
                currentServer = server;
                document
                    .querySelectorAll(".dock-item")
                    .forEach((el) =>
                        el.classList.toggle(
                            "active",
                            el.dataset.server === server,
                        ),
                    );
                document.getElementById("currentServerName").textContent =
                    CONFIG.SERVERS[server].name;
                document.getElementById("serverIP").textContent =
                    CONFIG.SERVERS[server].ip;
                // Refresh data for new server
                fetchStats();
                fetchConsole();
                fetchPlayers();
            }

            // ═══════════════════════════════════════════════════════
            // DOCK MAGNIFICATION
            // ═══════════════════════════════════════════════════════
            function initDock() {
                const dock = document.getElementById("dock");
                const items = dock.querySelectorAll(".dock-item");

                dock.addEventListener("mousemove", (e) => {
                    items.forEach((item) => {
                        const rect = item.getBoundingClientRect();
                        const centerX = rect.left + rect.width / 2;
                        const dist = Math.abs(e.clientX - centerX);
                        item.classList.remove("magnify-1", "magnify-2");
                        if (dist < 30) item.classList.add("magnify-2");
                        else if (dist < 70) item.classList.add("magnify-1");
                    });
                });

                dock.addEventListener("mouseleave", () => {
                    items.forEach((item) =>
                        item.classList.remove("magnify-1", "magnify-2"),
                    );
                });
            }

            // ═══════════════════════════════════════════════════════
            // API CALLS (communicate with the Paper plugin)
            // ═══════════════════════════════════════════════════════
            async function apiCall(endpoint) {
                try {
                    const res = await fetch(
                        `${CONFIG.API_BASE}/${currentServer}/${endpoint}`,
                        {
                            headers: {
                                Authorization: currentUser
                                    ? currentUser.id
                                    : "",
                            },
                        },
                    );
                    if (!res.ok) throw new Error("API error");
                    return await res.json();
                } catch (e) {
                    return null;
                }
            }

            async function apiPost(endpoint, body) {
                try {
                    const res = await fetch(
                        `${CONFIG.API_BASE}/${currentServer}/${endpoint}`,
                        {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                                Authorization: currentUser
                                    ? currentUser.id
                                    : "",
                            },
                            body: JSON.stringify(body),
                        },
                    );
                    if (!res.ok) throw new Error("API error");
                    return await res.json();
                } catch (e) {
                    return null;
                }
            }

            // ═══════════════════════════════════════════════════════
            // STATS POLLING
            // ═══════════════════════════════════════════════════════
            function startPolling() {
                fetchStats();
                fetchConsole();
                fetchPlayers();
                statsPolling = setInterval(() => {
                    fetchStats();
                    fetchPlayers();
                }, 3000);
                consolePolling = setInterval(fetchConsole, 2000);
            }

            function stopPolling() {
                clearInterval(statsPolling);
                clearInterval(consolePolling);
            }

            async function fetchStats() {
                const data = await apiCall("stats");
                if (!data) {
                    // Demo data when plugin is not connected
                    updateStats({
                        cpu: Math.round(15 + Math.random() * 30),
                        ramUsed: 2048 + Math.round(Math.random() * 1024),
                        ramMax: 8192,
                        playerCount: 0,
                        online: false,
                    });
                    return;
                }
                updateStats(data);
            }

            function updateStats(d) {
                const cpu = d.cpu || 0;
                const ramUsed = d.ramUsed || 0;
                const ramMax = d.ramMax || 8192;
                const ramPct = Math.round((ramUsed / ramMax) * 100);
                const players = d.playerCount || 0;

                document.getElementById("cpuValue").innerHTML =
                    cpu + "<small>%</small>";
                document.getElementById("cpuBar").style.width = cpu + "%";
                document.getElementById("topCpu").textContent = cpu + "%";

                document.getElementById("ramValue").innerHTML =
                    ramUsed + "<small> / " + ramMax + " MB</small>";
                document.getElementById("ramBar").style.width = ramPct + "%";
                document.getElementById("topRam").textContent = ramUsed + " MB";

                document.getElementById("playerCountValue").textContent =
                    players;
                document.getElementById("topPlayers").textContent = players;

                const dot = document.getElementById("serverDot");
                const status = document.getElementById("serverStatus");
                if (d.online !== false) {
                    dot.classList.remove("offline");
                    status.className = "status-badge status-online";
                    status.textContent = "En ligne";
                } else {
                    dot.classList.add("offline");
                    status.className = "status-badge status-offline";
                    status.textContent = "Hors ligne";
                }
            }

            async function fetchConsole() {
                const data = await apiCall("console");
                if (!data || !data.lines) return;
                const body = document.getElementById("consoleBody");
                const wasAtBottom =
                    body.scrollTop + body.clientHeight >=
                    body.scrollHeight - 20;
                body.innerHTML = data.lines.map(formatConsoleLine).join("");
                if (wasAtBottom) body.scrollTop = body.scrollHeight;
            }

            function formatConsoleLine(line) {
                let cls = "info";
                if (line.includes("WARN")) cls = "warn";
                if (line.includes("ERROR") || line.includes("SEVERE"))
                    cls = "error";
                if (
                    line.includes("joined") ||
                    line.includes("left") ||
                    line.includes("logged in")
                )
                    cls = "player";

                const timeMatch = line.match(/\[(\d{2}:\d{2}:\d{2})\]/);
                const time = timeMatch ? timeMatch[1] : "";
                const rest = timeMatch
                    ? line.substring(timeMatch[0].length)
                    : line;

                return `<div class="console-line"><span class="time">[${time}]</span> <span class="${cls}">${escapeHtml(rest)}</span></div>`;
            }

            function escapeHtml(text) {
                const d = document.createElement("div");
                d.textContent = text;
                return d.innerHTML;
            }

            async function sendCommand() {
                const input = document.getElementById("consoleInput");
                const cmd = input.value.trim();
                if (!cmd) return;
                input.value = "";
                await apiPost("command", { command: cmd });
                setTimeout(fetchConsole, 500);
            }

            // ═══════════════════════════════════════════════════════
            // PLAYERS
            // ═══════════════════════════════════════════════════════
            let playersData = [];

            async function fetchPlayers() {
                const data = await apiCall("players");
                if (!data || !data.players) {
                    // Show empty state
                    renderPlayerCountList([]);
                    return;
                }
                playersData = data.players;
                renderPlayerList(playersData);
                renderPlayerCountList(playersData);
            }

            function renderPlayerCountList(players) {
                const list = document.getElementById("playerCountList");
                if (!players.length) {
                    list.innerHTML =
                        '<span style="font-size:0.8rem;color:var(--text-muted);">Aucun joueur connecté</span>';
                    return;
                }
                list.innerHTML =
                    players
                        .slice(0, 5)
                        .map(
                            (p) =>
                                `<div class="player-count-item">
            <img src="https://mc-heads.net/avatar/${p.name}/20" class="player-mini-head" alt="">
            <span>${escapeHtml(p.name)}</span>
        </div>`,
                        )
                        .join("") +
                    (players.length > 5
                        ? `<span style="font-size:0.75rem;color:var(--text-muted);">+ ${players.length - 5} autres</span>`
                        : "");
            }

            function renderPlayerList(players) {
                const grid = document.getElementById("playerGrid");
                if (!players.length) {
                    grid.innerHTML = `<div style="text-align:center;padding:3rem;color:var(--text-muted);">
            <i class="fas fa-users" style="font-size:2rem;margin-bottom:1rem;display:block;opacity:0.3;"></i>
            Aucun joueur en ligne</div>`;
                    return;
                }

                grid.innerHTML = players
                    .map((p) => {
                        const world = formatWorld(p.world);
                        const pingClass =
                            p.ping < 80
                                ? "ping-good"
                                : p.ping < 200
                                  ? "ping-medium"
                                  : "ping-bad";
                        const rankClass = getRankClass(p.rank);
                        const healthPct = Math.round((p.health / 20) * 100);
                        const season = formatSuffix(p.suffix);

                        return `<div class="player-row${selectedPlayer === p.name ? " selected" : ""}" onclick="selectPlayer('${p.name}')">
            <img src="https://mc-heads.net/avatar/${p.name}/36" class="player-head" alt="">
            <div class="player-name-cell">${escapeHtml(p.name)}${season ? ` <span style="font-size:0.65rem;color:var(--accent-aqua);opacity:0.7;">${season}</span>` : ""}</div>
            <div class="player-health-cell">
                <div class="health-bar-mini"><div class="health-bar-fill" style="width:${healthPct}%"></div></div>
                <span style="color:var(--accent-red);font-size:0.75rem;">${Math.round(p.health * 10) / 10}</span>
            </div>
            <div class="player-world-cell ${world.class}"><i class="${world.icon}"></i> ${world.name}</div>
            <div class="player-ping-cell ${pingClass}">${p.ping}ms</div>
            <div class="player-rank-cell ${rankClass}">${escapeHtml(p.rank || "Joueur")}</div>
        </div>`;
                    })
                    .join("");
            }

            function formatWorld(w) {
                if (!w)
                    return {
                        name: "Inconnu",
                        icon: "fas fa-question",
                        class: "",
                    };
                if (
                    w === "world" ||
                    w.endsWith("_overworld") ||
                    (!w.includes("nether") && !w.includes("end"))
                )
                    return {
                        name: "Overworld",
                        icon: "fas fa-tree",
                        class: "world-overworld",
                    };
                if (w.includes("nether"))
                    return {
                        name: "Nether",
                        icon: "fas fa-fire",
                        class: "world-nether",
                    };
                if (w.includes("end"))
                    return {
                        name: "End",
                        icon: "fas fa-dragon",
                        class: "world-end",
                    };
                return { name: w, icon: "fas fa-globe", class: "" };
            }

            function formatSuffix(suffix) {
                if (!suffix) return "";
                if (suffix.includes("%img_sun%")) return "Saison 1";
                if (suffix.includes("%img_sdeux%")) return "Saison 2";
                if (suffix.includes("%img_strois%")) return "Saison 3";
                if (suffix.includes("%img_squatre%")) return "Saison 4";
                if (suffix.includes("%img_scinq%")) return "Saison 5";
                if (suffix.includes("%img_start%")) return "STAFF";
                return "";
            }

            function getRankClass(rank) {
                if (!rank) return "rank-default";
                const r = rank.toLowerCase();
                if (r.includes("admin") || r.includes("owner"))
                    return "rank-admin";
                if (
                    r.includes("mod") ||
                    r.includes("staff") ||
                    r.includes("helper")
                )
                    return "rank-staff";
                if (r.includes("vip") || r.includes("premium"))
                    return "rank-vip";
                return "rank-default";
            }

            function filterPlayers() {
                const q = document
                    .getElementById("playerSearchInput")
                    .value.toLowerCase();
                const filtered = playersData.filter((p) =>
                    p.name.toLowerCase().includes(q),
                );
                renderPlayerList(filtered);
            }

            async function selectPlayer(name) {
                selectedPlayer = name;
                const layout = document.getElementById("joueursLayout");
                layout.classList.remove("no-selection");
                const detail = document.getElementById("playerDetail");
                detail.style.display = "flex";

                // Re-render list to show selection
                renderPlayerList(playersData);

                // Fetch detailed player info
                detail.innerHTML = `<div style="display:flex;align-items:center;justify-content:center;height:200px;color:var(--text-muted);"><i class="fas fa-spinner fa-spin" style="margin-right:0.5rem;"></i> Chargement...</div>`;

                const data = await apiCall("player/" + name);
                if (!data) {
                    // Use basic data from list
                    const p = playersData.find((x) => x.name === name);
                    if (p) renderPlayerDetail(p);
                    else
                        detail.innerHTML =
                            '<div style="padding:2rem;text-align:center;color:var(--text-muted);">Impossible de charger les données.</div>';
                    return;
                }
                renderPlayerDetail(data);
            }

            function renderPlayerDetail(p) {
                const world = formatWorld(p.world);
                const season = formatSuffix(p.suffix);
                const rankClass = getRankClass(p.rank);

                const sanctions = (p.sanctions || [])
                    .map((s) => {
                        const typeClass =
                            s.type === "BAN"
                                ? "ban"
                                : s.type === "TEMPBAN"
                                  ? "tempban"
                                  : s.type === "MUTE" || s.type === "TEMPMUTE"
                                    ? "mute"
                                    : "kick";
                        const typeLabel =
                            s.type === "BAN"
                                ? "🔴 BAN"
                                : s.type === "TEMPBAN"
                                  ? "🟠 TEMPBAN"
                                  : s.type === "MUTE"
                                    ? "🟡 MUTE"
                                    : s.type === "TEMPMUTE"
                                      ? "🟡 TEMPMUTE"
                                      : "⚡ KICK";
                        return `<div class="sanction-item ${typeClass}">
            <div class="sanction-type">${typeLabel}</div>
            <div class="sanction-reason">${escapeHtml(s.reason || "Aucune raison")}</div>
            <div class="sanction-meta">Par ${escapeHtml(s.operator || "?")} — ${s.date || "?"}${s.duration ? " — Durée: " + s.duration : ""}</div>
        </div>`;
                    })
                    .join("");

                const altNames = (p.altNames || [])
                    .map(
                        (n) =>
                            `<span class="alt-name-tag">${escapeHtml(n)}</span>`,
                    )
                    .join("");

                document.getElementById("playerDetail").innerHTML = `
        <div class="player-detail-header">
            <img src="https://mc-heads.net/body/${p.name}/200" class="player-skin-3d" alt="${p.name}" onerror="this.src='https://mc-heads.net/avatar/${p.name}/120'">
            <div class="player-detail-name">${escapeHtml(p.name)}</div>
            <div class="player-detail-rank ${rankClass}">${escapeHtml(p.rank || "Joueur")}</div>
            ${season ? `<div class="player-detail-season"><i class="fas fa-medal"></i> ${season}</div>` : ""}
        </div>
        <div class="player-detail-body">
            <div class="detail-section">
                <div class="detail-section-title"><i class="fas fa-info-circle"></i> Informations</div>
                <div class="detail-row"><span class="detail-label">UUID</span><span class="detail-value" style="font-size:0.7rem;">${p.uuid || "—"}</span></div>
                <div class="detail-row"><span class="detail-label">IP</span><span class="detail-value">${p.ip || "—"}</span></div>
                <div class="detail-row"><span class="detail-label">Monde</span><span class="detail-value">${world.name}</span></div>
                <div class="detail-row"><span class="detail-label">Vie</span><span class="detail-value" style="color:var(--accent-red);">${p.health ? Math.round(p.health * 10) / 10 + " ❤" : "—"}</span></div>
                <div class="detail-row"><span class="detail-label">Ping</span><span class="detail-value">${p.ping ? p.ping + "ms" : "—"}</span></div>
            </div>
            <div class="detail-section">
                <div class="detail-section-title"><i class="fas fa-clock"></i> Activité</div>
                <div class="detail-row"><span class="detail-label">Première connexion</span><span class="detail-value">${p.firstJoin || "—"}</span></div>
                <div class="detail-row"><span class="detail-label">Dernière connexion</span><span class="detail-value">${p.lastJoin || "—"}</span></div>
                <div class="detail-row"><span class="detail-label">Temps de jeu</span><span class="detail-value">${p.playTime || "—"}</span></div>
            </div>
            ${
                p.altNames && p.altNames.length
                    ? `
            <div class="detail-section">
                <div class="detail-section-title"><i class="fas fa-user-friends"></i> Comptes liés (même IP)</div>
                <div class="detail-alt-names">${altNames}</div>
            </div>`
                    : ""
            }
            <div class="detail-section">
                <div class="detail-section-title"><i class="fas fa-gavel"></i> Historique des Sanctions</div>
                ${sanctions ? `<div class="sanction-list">${sanctions}</div>` : '<div class="no-sanctions">Aucune sanction enregistrée</div>'}
            </div>
        </div>
    `;
            }

            // ═══════════════════════════════════════════════════════
            // COPY IP
            // ═══════════════════════════════════════════════════════
            function copyIP() {
                const ip = document.getElementById("serverIP").textContent;
                navigator.clipboard.writeText(ip).then(() => {
                    const el = document.querySelector(".console-ip");
                    el.style.background = "rgba(16, 185, 129, 0.2)";
                    setTimeout(() => (el.style.background = ""), 1000);
                });
            }

            // ═══════════════════════════════════════════════════════
            // ANNONCE DISCORD
            // ═══════════════════════════════════════════════════════
            document
                .getElementById("uploadZone")
                ?.addEventListener("dragover", (e) => {
                    e.preventDefault();
                    document
                        .getElementById("uploadZone")
                        .classList.add("dragover");
                });
            document
                .getElementById("uploadZone")
                ?.addEventListener("dragleave", () =>
                    document
                        .getElementById("uploadZone")
                        .classList.remove("dragover"),
                );
            document
                .getElementById("uploadZone")
                ?.addEventListener("drop", (e) => {
                    e.preventDefault();
                    document
                        .getElementById("uploadZone")
                        .classList.remove("dragover");
                    handleFiles(e.dataTransfer.files);
                });
            document
                .getElementById("imageInput")
                ?.addEventListener("change", (e) =>
                    handleFiles(e.target.files),
                );
            document.addEventListener("paste", (e) => {
                if (
                    document
                        .getElementById("tab-annonce")
                        .classList.contains("active")
                ) {
                    for (let i of e.clipboardData.items)
                        if (i.type.startsWith("image/"))
                            handleFiles([i.getAsFile()]);
                }
            });

            function handleFiles(files) {
                for (let f of files) {
                    if (uploadedImages.length >= 4) break;
                    if (
                        f.size > 50 * 1024 * 1024 ||
                        !f.type.startsWith("image/")
                    )
                        continue;
                    const r = new FileReader();
                    r.onload = (e) => {
                        uploadedImages.push({
                            data: e.target.result,
                            name: f.name,
                        });
                        renderPreviews();
                    };
                    r.readAsDataURL(f);
                }
            }

            function renderPreviews() {
                document.getElementById("imagePreviewGrid").innerHTML =
                    uploadedImages
                        .map(
                            (img, i) =>
                                `<div class="image-preview-item"><img src="${img.data}"><button class="image-remove-btn" onclick="uploadedImages.splice(${i},1);renderPreviews()"><i class="fas fa-times"></i></button></div>`,
                        )
                        .join("");
            }

            document.getElementById("btnReset").onclick = () => {
                document.getElementById("announcementTitle").value = "";
                document.getElementById("announcementDescription").value = "";
                uploadedImages = [];
                document.getElementById("imagePreviewGrid").innerHTML = "";
                document.getElementById("signatureCheckbox").checked = false;
            };

            document.getElementById("btnConfirm").onclick = () => {
                const title = document
                    .getElementById("announcementTitle")
                    .value.trim();
                const desc = document
                    .getElementById("announcementDescription")
                    .value.trim();
                if (!title || !desc)
                    return alert("Remplissez le titre et la description");

                document.getElementById("previewTime").textContent =
                    new Date().toLocaleTimeString("fr-FR", {
                        hour: "2-digit",
                        minute: "2-digit",
                    });
                const sig = document.getElementById("signatureCheckbox").checked
                    ? currentUser.username
                    : "l'Équipe True Vanilla";
                document.getElementById("previewMessageText").innerHTML =
                    `<span class="mention">@everyone</span>\n<span class="heading"># ${escapeHtml(title)}</span>\n\n${escapeHtml(desc)}\n\n<span class="signature">*- ${escapeHtml(sig)}*</span>`;
                document.getElementById("previewImages").innerHTML =
                    uploadedImages.length
                        ? uploadedImages
                              .map((i) => `<img src="${i.data}">`)
                              .join("")
                        : "";
                document.getElementById("previewImages").className =
                    "discord-embed-images" +
                    (uploadedImages.length === 1 ? " single" : "");

                selectedChannel = null;
                document.getElementById("btnVip").classList.remove("selected");
                document
                    .getElementById("btnGeneral")
                    .classList.remove("selected");
                document.getElementById("btnSend").disabled = true;
                document
                    .getElementById("previewOverlay")
                    .classList.add("active");
            };

            function selectChannel(ch) {
                selectedChannel = ch;
                document
                    .getElementById("btnVip")
                    .classList.toggle("selected", ch === "vip");
                document
                    .getElementById("btnGeneral")
                    .classList.toggle("selected", ch === "general");
                document.getElementById("btnSend").disabled = false;
            }

            function closePreview() {
                document
                    .getElementById("previewOverlay")
                    .classList.remove("active");
            }
            document.getElementById("previewOverlay").onclick = (e) => {
                if (e.target === document.getElementById("previewOverlay"))
                    closePreview();
            };

            async function sendAnnouncement() {
                if (!selectedChannel) return;
                const btn = document.getElementById("btnSend");
                btn.disabled = true;
                btn.innerHTML =
                    '<i class="fas fa-spinner fa-spin"></i> Envoi...';

                const sig = document.getElementById("signatureCheckbox").checked
                    ? currentUser.username
                    : "l'Équipe True Vanilla";
                const title = document
                    .getElementById("announcementTitle")
                    .value.trim();
                const desc = document
                    .getElementById("announcementDescription")
                    .value.trim();
                const content = `||@everyone||\n# ${title}\n\n${desc}\n\n*- ${sig}*`;

                try {
                    const webhookUrl = CONFIG.WEBHOOKS[selectedChannel];
                    if (uploadedImages.length) {
                        const fd = new FormData();
                        fd.append("payload_json", JSON.stringify({ content }));
                        for (let i = 0; i < uploadedImages.length; i++) {
                            const b = await fetch(uploadedImages[i].data).then(
                                (r) => r.blob(),
                            );
                            fd.append(
                                `file${i}`,
                                b,
                                uploadedImages[i].name || `img${i}.png`,
                            );
                        }
                        await fetch(webhookUrl, { method: "POST", body: fd });
                    } else {
                        await fetch(webhookUrl, {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ content }),
                        });
                    }

                    document
                        .getElementById("previewOverlay")
                        .classList.remove("active");
                    document
                        .getElementById("successOverlay")
                        .classList.add("active");
                    setTimeout(
                        () =>
                            document
                                .getElementById("successOverlay")
                                .classList.remove("active"),
                        3000,
                    );

                    // Reset form
                    document.getElementById("announcementTitle").value = "";
                    document.getElementById("announcementDescription").value =
                        "";
                    uploadedImages = [];
                    document.getElementById("imagePreviewGrid").innerHTML = "";
                    document.getElementById("signatureCheckbox").checked =
                        false;
                } catch (e) {
                    alert("Erreur: " + e.message);
                } finally {
                    btn.disabled = false;
                    btn.innerHTML =
                        '<i class="fas fa-paper-plane"></i> Envoyer sur Discord';
                }
            }

            document.addEventListener("keydown", (e) => {
                if (e.key === "Escape") closePreview();
            });

            // ═══════════════════════════════════════════════════════
            // INIT
            // ═══════════════════════════════════════════════════════
            document.addEventListener("DOMContentLoaded", async () => {
                createParticles();

                // Check for stored session
                const stored = sessionStorage.getItem("tv_admin_user");
                if (stored) {
                    currentUser = JSON.parse(stored);
                    showApp();
                    return;
                }

                // Check for OAuth callback
                if (window.location.hash.includes("access_token")) {
                    await handleOAuthCallback();
                }
            });
        </script>
    </body>
</html>
